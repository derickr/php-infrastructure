<VirtualHost *:80>
	# Host and Document Root
	ServerName {{ analytics_domain }}
	ServerAlias {{ analytics_domain_alias }}
	Redirect / https://{{ analytics_domain }}/

	# Logging
	ErrorLog ${APACHE_LOG_DIR}/{{ analytics_domain }}-error.log
	CustomLog ${APACHE_LOG_DIR}/{{ analytics_domain }}-access.log combined
</VirtualHost>

<VirtualHost *:443>
	# Host and Document Root
	ServerName {{ analytics_domain }}
	ServerAlias {{ analytics_domain_alias }}
	DocumentRoot {{ analytics_docroot }}/{{ analytics_domain }}/www

	<Directory {{ analytics_docroot }}/{{ analytics_domain }}/>
		Options FollowSymLinks MultiViews
		AllowOverride None
		Require all granted
	</Directory>

    DirectoryIndex index.php

	# Logging
	ErrorLog ${APACHE_LOG_DIR}/{{ analytics_domain }}-error.log
	CustomLog ${APACHE_LOG_DIR}/{{ analytics_domain }}-access.log combined

	# TLS Configuration with self-signed certificates
	SSLEngine on
	SSLCertificateFile /etc/ssl/certs/php-self-signed.crt
	SSLCertificateKeyFile /etc/ssl/certs/php-self-signed.key

	ErrorDocument 404  /error/404.php
</VirtualHost>
